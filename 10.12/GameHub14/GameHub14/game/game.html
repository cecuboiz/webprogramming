<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>Game Detail</title>
  <link rel="stylesheet" href="game.css"> <!-- ğŸ”¹ game ì „ìš© CSS -->
  <script src="../script.js" defer></script>
</head>
<body class="detail-page">
  <header class="navbar">
    <div class="logo" onclick="location.href='../index.html'">
      <i class="ri-game-fill"></i>
      <p>GameHub</p>
    </div>
    <div class="nav-buttons">
      <button onclick="location.href='../index.html'">ğŸ  í™ˆìœ¼ë¡œ</button>
    </div>
  </header>

  <div class="detail-root">
    <!-- ì¢Œì¸¡ -->
    <div class="media-card">
      <div class="media-frame">
        <img id="mediaImg" class="media-img hidden">
        <div id="mediaPh" class="placeholder">ì´ë¯¸ì§€ ì—†ìŒ</div>
      </div>
      
      <div class="rate-box">
        <p class="rate-title">ë³„ì  í‰ê°€</p>
        <div id="stars" class="stars">
          <span class="star" data-v="1">â˜…</span>
          <span class="star" data-v="2">â˜…</span>
          <span class="star" data-v="3">â˜…</span>
          <span class="star" data-v="4">â˜…</span>
          <span class="star" data-v="5">â˜…</span>
        </div>
      </div>
    </div>

    <!-- ìš°ì¸¡ -->
    <div class="info">
      <h1 id="titleEl" class="game-title">ê²Œì„ ì œëª©</h1>
      <p id="subEl" class="title-meta">ì œì‘ì‚¬ Â· ì—°ë„</p>

      <div class="metric-row">
        <span id="ratingEl" class="score"><span class="icon">â˜…</span>4.8</span>
        <span><span id="likeCount">74,231</span> ì¶”ì²œ</span>
      </div>

      <div class="badges">
        <span id="chipGenre" class="badge">RPG</span>
        <div id="chipTags" class="badges"></div>
      </div>

      <h3 class="section-title">ê²Œì„ ì†Œê°œ</h3>
      <p id="descEl" class="section-body"></p>

      <h3 class="section-title">ê²Œì„ íŠ¹ì§•</h3>
      <div id="featureRow" class="features"></div>

      <button id="btnRecommend" class="cta">ğŸ‘ ì´ ê²Œì„ ì¶”ì²œí•˜ê¸°</button>
      <button id="delete-btn" class="delete-btn hidden" onclick="deleteThisGame()">ğŸ—‘ï¸ ì´ ê²Œì„ ì‚­ì œí•˜ê¸°</button>
    </div>
  </div>

  <!-- ëŒ“ê¸€ ì„¹ì…˜ -->
  <section id="commentsSection" class="comments">
    <h2 class="comments-title">ëŒ“ê¸€ (<span id="cmtCount">0</span>)</h2>

    <div class="comment-editor">
      <textarea id="cmtInput" rows="4" placeholder="ëŒ“ê¸€ì„ ë‚¨ê²¨ì£¼ì„¸ìš”..."></textarea>
      <button id="cmtSubmit" class="comment-submit">ëŒ“ê¸€ ë“±ë¡</button>
    </div>

    <ul id="cmtList" class="comment-list"></ul>
  </section>

  <script>
    // í˜ì´ì§€ ë¡œë“œ ì‹œ ëŒ“ê¸€ ì´ˆê¸°í™”
    window.addEventListener("load", () => {
      if (typeof initGameCommentsView === "function") {
        initGameCommentsView();     // script.jsì— êµ¬í˜„(ì•„ë˜ 3ë²ˆ)
      }
    });

    // ğŸŸ¢ ë¡œê·¸ì¸í•œ ì‚¬ìš©ìê°€ ì´ ê²Œì„ì„ ë“±ë¡í–ˆìœ¼ë©´ ì‚­ì œ ë²„íŠ¼ í‘œì‹œ
      const params = new URLSearchParams(window.location.search);
      const id = parseInt(params.get("id"));
      const games = JSON.parse(localStorage.getItem("games") || "[]");
      const game = games.find(g => g.id === id);

      const email = localStorage.getItem("loggedInUser");
      if (game.creator === email) {
        document.querySelector(".delete-btn")?.classList.remove("hidden");
      } else {
        document.querySelector(".delete-btn")?.classList.add("hidden");
      }
  </script>
</body>
</html>